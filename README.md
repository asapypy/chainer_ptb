# chainer_ptb

ロボケンのみなさま
=================

LSTM は chainer の公式 GitHub からダウンロードしてください。
こちらには GRU を使ったバージョンをアップしたました。

加えて，学習済のファイルもアップしてあります。評価用にお使いください

rnnlm.model
-----------
公式サンプルの学習済結合係数ファイル

rnnlm.state
-----------
同上で，その状態ファイル

train_ptbGRU.py
---------------
GRU を使った PTB の訓練をする python コード

netGRU.py
---------
上記の補助ファイル

rnnlmGRU.model
--------------
GRU 版の学習済結合係数ファイル

rnnlmGRU.state
--------------
上記の状態ファイル


まず最初にすべきこと
===================
Chainer のインストールです。

> pip install chainer

してください。そうしないと話が始まりません。GRU 版の ptb を開始するには

> python train_ptbGRU.py

です。訓練済のファイルから始めるには

> python tran_ptgGRU.py --initmodel rnnlmGRU.model --resume rnnlmGRU.state

です。ですが，ソースコードのとおりこれはサンプルプログラムです。
このようにしても必ず決まった回数だけ訓練してしまいます。
PFN の提供しているサンプルコードですので，自分で改造する必要があります。
ご了承ください。

予測用コード
===========
pred_ptb.py を作りました。使い方は

> python pred_ptb.py --initmodel rnnlm.model

です。デフォルトでは最初の100系列までを予測します。一行あたり３単語出力されますが，それぞれ入力単語，教師単語(すなわち次の単語), 予測 です。最後に精度を出力して終わります。このコードの下から４行目を書き換えると別の場所の予測になります。train_data[:100]となっていますから，最初の１００語です。これをtrain_data[10:15] にすれば最初から11番めから16番目までになります。0から始まるのでプラス１します。
train_data じゃなくて test_data にすれば，訓練中には学習しなかった系列を予測する課題になります。

